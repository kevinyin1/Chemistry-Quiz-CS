<!--
DO NOT LINK THIS PAGE
-->

<!doctype html>
	<html>
		<head>
			<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
			<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
			<!-- Latest compiled and minified JavaScript -->
			<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
			<!-- Link to stylesheets -->
			<link rel="stylesheet" href="stylesheet/admincss.css">
			<link rel="stylesheet" href="stylesheet/ionicons.css">
			<!-- Firebase -->
			<script src="https://www.gstatic.com/firebasejs/3.6.1/firebase.js"></script>
			<script src="javascript/adminauth.js"></script>
			<script src="javascript/mustache.js"></script>
		</head>
		<body>
			<script id="quiztemplate" type="text/template">
				<div class="item">
				  <div class="panel panel-default">
					<div class="panel-heading">{{question}}</div>
					  <div class="panel-body">
						<img href="{{imglink}}" alt="imglink" style="float:left;width:400px;">
						<div style="float:left;width:400px">
						<div>a) {{answerA}}</div>
						<div>b) {{answerB}}</div>
						<div>c) {{answerC}}</div>
						<div>d) {{answerD}}</div>
						<div>e) {{answer}}</div>
						<div>Hint) {{hint}}</div>
					  </div>
					</div>
				 </div>
			</script>
			<script type="text/javascript">
				// Initialize Firebase
				var config = {
					apiKey: "AIzaSyCtmRFEI7sYJykO0q_l20nl521GRt0U8Vg",
					authDomain: "csquizproject.firebaseapp.com",
					databaseURL: "https://csquizproject.firebaseio.com",
					storageBucket: "csquizproject.appspot.com",
					messagingSenderId: "70741320633"
				};
				firebase.initializeApp(config);

				function loginbtn(){
					//get email and pass value
					email = document.getElementById('email').value;
					password = document.getElementById('pass').value;
					var auth = firebase.auth();
					if (auth.currentUser) {
						auth.signOut();
					} else {
					//sign in
						auth.signInWithEmailAndPassword(email, password).catch(function(error){
							var errorCode = error.code;
							var errorMsg = error.message;
							if (errorCode === 'auth/wrong-password'){
								$("#alert1").fadeIn(1500, function(){
	            					$("#alert1").fadeOut(1500);
	        					});
							}else{
								$("#alert2").fadeIn(1500, function(){
	            					$("#alert2").fadeOut(1500);
	        					});
							}
							console.log(errorMsg);
						});
				    }
				};

				function logoutbtn(){
					firebase.auth().signOut();
				}
//creating questions
				function create(){
					var database = firebase.database().ref('questions');
					var question = document.getElementById('ques').value;
					var ansA = document.getElementById('ansA').value;
					var ansB = document.getElementById('ansB').value;
					var ansC = document.getElementById('ansC').value;
					var ansD = document.getElementById('ansD').value;
					var ans = document.getElementById('ans').value;
					var hint = document.getElementById('hint').value;
					var imglink = document.getElementById('imagelink').value;
					console.log('work');
					database.push({
						"question":question,
						"answerA":ansA,
						"answerB":ansB,
						"answerC":ansC,
						"answerD":ansD,
						"answer":ans,
						"hint":hint,
						"imglink":imglink
					});
				}



					firebase.auth().onAuthStateChanged(function(user) {
					  if (user) {
						  console.log('logged in');
						  $('#login').addClass('hide');
						  $('#logout').removeClass('hide');
						  $('#output').removeClass('hide');

						  /*~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~*/
						  //document.getElementById('output').innerHTML = '<div class="panel panel-default"><div class="panel-heading">Heading<button onclick="update()" class="btn btn-primary" id="update">Update</button></div><div class="panel-body">A Basic Panel</div></div>';
						 // document.getElementById('output').style.marginTop = ((screen.height)-(document.getElementById('container').style.height)).toString()+"px";
						  var database = firebase.database().ref('questions');
							var data, build;
			   				var myTemplate = $("#quiztemplate").html()
	           				database.on('value',function(snapshot){
					   			build = "";
		          				data = snapshot.val();
		           				for(key in data){
									build += Mustache.render(myTemplate,data[key]);
			        			    //console.log(data[key]);
		            			}
								$("#outputques").html(build);
							});



					  } else {
						  $('#login').removeClass('hide');
						  $('#logout').addClass('hide');
						  console.log('logged out');
						  $('#output').addClass('hide');
					  }
					});


			</script>
			<div class="container">
				<span class="glyp ion-ionic"> </span>
				<h3>Administrator</h3>
				<input id="email" placeholder="Email" type="email">
				<input id="pass" placeholder="Password" type="password">
				<button onclick="loginbtn()" id="login" class="btn btn-primary">Login</button>
				<button onclick="logoutbtn()" id="logout" class="btn btn-secondary hide">Logout</button>
				<div class="alert alert-danger" id="alert1">Wrong Password!</div>
				<div class="alert alert-danger" id="alert2">Incorrect!</div>
			</div>
			<div id="output" class="hide">
				<div class="panel panel-default">
					<div class="panel-heading">Create a question<button onclick="create()" class="btn btn-primary" id="btn">Create</button></div>
					<div class="panel-body">
						<div id="createpanel">
							<div class="col-xs-4">
								Question: <input placeholder="Question" id="ques" style="width:350px;"><br>
							</div>
							<div class="col-xs-4">
								Answer Choice A:<input placeholder="Answer A" id="ansA"><br>
								Answer Choice B:<input placeholder="Answer B" id="ansB"><br>
								Answer Choice C:<input placeholder="Answer C" id="ansC"><br>
								Answer Choice D:<input placeholder="Answer D" id="ansD"><br>
								Answer:<input placeholder="Answer" id="ans"><br>
							</div>
							<div class="col-xs-4">
								Image Names: <input placeholder="image link" id="imagelink"><br>
								Hint: <input placeholder="Hint" id="hint"><br>
							</div>
						</div>
					</div>
				</div>
				<div class="panel panel-default">
					<div class="panel-heading">List of Questions</div>
					<div class="panel-body" id="outputques">

					</div>
				</div>
			</div>
		</body>
	</html>
